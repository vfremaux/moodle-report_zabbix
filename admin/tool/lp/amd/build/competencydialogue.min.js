define(["jquery","core/notification","core/ajax","core/templates","core/str","tool_lp/dialogue"],function(i,c,o,a,e,r){function t(){}var n;return t.prototype.triggerCompetencyViewedEvent=function(e){o.call([{methodname:"core_competency_competency_viewed",args:{id:e}}])},t.prototype.showDialogue=function(o,e){var e=this.getCompetencyDataPromise(o,e),n=this;e.done(function(t){a.render("tool_lp/competency_summary",t).done(function(e){n.triggerCompetencyViewedEvent(o),new r(t.competency.shortname,e)}).fail(c.exception)}).fail(c.exception)},t.prototype.showDialogueFromData=function(t){var o=this;a.render("tool_lp/competency_summary",t).done(function(e){o.triggerCompetencyViewedEvent(t.id),new r(t.shortname,e,o.enhanceDialogue)}).fail(c.exception)},t.prototype.clickEventHandler=function(e){var t=e.data.compdialogue,o=i(e.currentTarget),n=o.data("id"),c=!o.data("excluderelated"),o=o.data("includecourses");t.showDialogue(n,{includerelated:c,includecourses:o}),e.preventDefault()},t.prototype.getCompetencyDataPromise=function(e,t){return o.call([{methodname:"tool_lp_data_for_competency_summary",args:{competencyid:e,includerelated:t.includerelated||!1,includecourses:t.includecourses||!1}}])[0].then(function(e){return e}).fail(c.exception)},{init:function(){void 0===n&&(n=new t,i("body").delegate('[data-action="competency-dialogue"]',"click",{compdialogue:n},n.clickEventHandler.bind(n)))}}});