define(["jquery","core/templates","core/ajax","core/notification","core/str"],function(n,t,o,a,c){function r(){var e=o.call([{methodname:"core_competency_delete_competency_framework",args:{id:i}},{methodname:"tool_lp_data_for_competency_frameworks_manage_page",args:{pagecontext:{contextid:m}}}]);e[0].done(function(e){!1===e&&o.call([{methodname:"core_competency_read_competency_framework",args:{id:i}}])[0].done(function(e){c.get_strings([{key:"frameworkcannotbedeleted",component:"tool_lp",param:e.shortname},{key:"cancel",component:"moodle"}]).done(function(e){a.alert(null,e[0])}).fail(a.exception)})}).fail(a.exception),e[1].done(d).fail(a.exception)}var m=0,i=0,l=function(e,o){n('[data-region="managecompetencies"]').replaceWith(e),t.runTemplateJS(o)},d=function(e){t.render("tool_lp/manage_competency_frameworks_page",e).done(l).fail(a.exception)};return{deleteHandler:function(e){e.preventDefault();e=n(this).attr("data-frameworkid");i=e,o.call([{methodname:"core_competency_read_competency_framework",args:{id:i}}])[0].done(function(e){c.get_strings([{key:"confirm",component:"moodle"},{key:"deletecompetencyframework",component:"tool_lp",param:e.shortname},{key:"delete",component:"moodle"},{key:"cancel",component:"moodle"}]).done(function(e){a.confirm(e[0],e[1],e[2],e[3],r)}).fail(a.exception)}).fail(a.exception)},duplicateHandler:function(e){e.preventDefault(),i=n(this).attr("data-frameworkid"),o.call([{methodname:"core_competency_duplicate_competency_framework",args:{id:i}},{methodname:"tool_lp_data_for_competency_frameworks_manage_page",args:{pagecontext:{contextid:m}}}])[1].done(d).fail(a.exception)},init:function(e){m=e}}});