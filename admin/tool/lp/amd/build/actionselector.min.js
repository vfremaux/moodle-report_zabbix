define(["jquery","core/notification","core/ajax","core/templates","tool_lp/dialogue","tool_lp/event_base"],function(o,e,t,r,n,i){function c(e,t,o,n,r){var c=this;i.prototype.constructor.apply(this,[]),c._title=e,c._message=t,c._actions=o,c._confirm=n,c._cancel=r,c._selectedValue=null,c._reset()}return(c.prototype=Object.create(i.prototype))._selectedValue=null,c.prototype._popup=null,c.prototype._title=null,c.prototype._message=null,c.prototype._actions=null,c.prototype._confirm=null,c.prototype._cancel=null,c.prototype._afterRender=function(){var t=this;t._find('[data-action="action-selector-confirm"]').attr("disabled","disabled"),t._find('[data-region="action-selector-radio-buttons"]').change(function(){t._selectedValue=o("input[type='radio']:checked").val(),t._find('[data-action="action-selector-confirm"]').removeAttr("disabled"),t._refresh.bind(t)}),t._find('[data-action="action-selector-cancel"]').click(function(e){e.preventDefault(),t.close()}),t._find('[data-action="action-selector-confirm"]').click(function(e){e.preventDefault(),t._selectedValue.length&&(t._trigger("save",{action:t._selectedValue}),t.close())})},c.prototype.close=function(){this._popup.close(),this._reset()},c.prototype.display=function(){var t=this;return t._render().then(function(e){t._popup=new n(t._title,e,t._afterRender.bind(t))}).fail(e.exception)},c.prototype._find=function(e){return o(this._popup.getContent()).find(e)},c.prototype._refresh=function(){var t=this;return t._render().then(function(e){t._find('[data-region="action-selector"]').replaceWith(e),t._afterRender()})},c.prototype._render=function(){var e,t=this,o=[];for(e in t._actions)o.push(t._actions[e]);var n={message:t._message,choices:o,confirm:t._confirm,cancel:t._cancel};return r.render("tool_lp/action_selector",n)},c.prototype._reset=function(){this._popup=null,this._selectedValue=""},c});