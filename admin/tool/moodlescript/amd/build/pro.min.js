define(["jquery","core/log","core/config"],function(s,o,a){var p={component:"tool_moodlescript",shortcomponent:"tool_moodlescript",componentpath:"tool/moodlescript",init:function(){var e="#id_s_"+p.component+"_licensekey";s(e).bind("change",this.check_product_key),s(e).trigger("change"),o.debug("AMD Pro js initialized for "+p.component+" system")},check_product_key:function(){var o="#id_s_"+p.component+"_licensekey",e=s(this),i=e.val().replace(/-/g,""),r=i.substr(0,14),i=i.substr(14,2),r=p.checksum(r),t=' <img src="'+a.wwwroot+'/pix/i/valid.png">',c=' <img src="'+a.wwwroot+'/pix/i/warning.png">',n=' <img src="'+a.wwwroot+'/pix/i/invalid.png">',m=' <img src="'+a.wwwroot+'/pix/i/ajaxloader.gif">';i===r?(i=(i=(i=a.wwwroot+"/"+p.componentpath+"/pro/ajax/services.php?what=license&service=check")+"&customerkey="+e.val())+"&provider="+s("#id_s_"+p.component+"_licenseprovider").val(),s(o+" + img").remove(),s(o).after(m),s.get(i,function(e){e.match(/SET OK/)?e.match(/-\d+.*$/)?(s(o+" + img").remove(),s(o).after(c)):(s(o+" + img").remove(),s(o).after(t)):(s(o+" + img").remove(),s(o).after(n))},"html")):(s(o+" + img").remove(),s(o).after(c))},checksum:function(e){var o,i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),r=i.length,t=e.split(""),c=0;for(o in t)c+=t[o].charCodeAt(0);e=Math.floor(c/r)%r;return""+i[c%r]+i[e]}};return p});