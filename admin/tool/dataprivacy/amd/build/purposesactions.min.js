define(["jquery","core/ajax","core/notification","core/str","core/modal_factory","core/modal_events"],function(a,i,c,t,s,d){function e(){this.registerEvents()}var o='[data-action="deletepurpose"]';return e.prototype.registerEvents=function(){a(o).click(function(e){e.preventDefault();var r=a(this).data("id"),e=a(this).data("name");t.get_strings([{key:"deletepurpose",component:"tool_dataprivacy"},{key:"deletepurposetext",component:"tool_dataprivacy",param:e},{key:"delete"}]).then(function(e){var t=e[0],o=e[1],n=e[2];return s.create({title:t,body:o,type:s.types.SAVE_CANCEL}).then(function(e){return e.setSaveButtonText(n),e.getRoot().on(d.save,function(){i.call([{methodname:"tool_dataprivacy_delete_purpose",args:{id:r}}])[0].done(function(e){e.result?a('tr[data-purposeid="'+r+'"]').remove():c.addNotification({message:e.warnings[0].message,type:"error"})}).fail(c.exception)}),e.getRoot().on(d.hidden,function(){e.destroy()}),e})}).done(function(e){e.show()}).fail(c.exception)})},{init:function(){return new e}}});