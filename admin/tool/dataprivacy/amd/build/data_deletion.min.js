define(["jquery","core/ajax","core/notification","core/str","core/modal_factory","core/modal_events"],function(c,i,r,a,s,d){function e(){this.registerEvents()}var t='[data-action="markfordeletion"]',o='[data-action="selectall"]',f=".selectcontext";return e.prototype.registerEvents=function(){c(t).click(function(e){e.preventDefault();var t,o,n=[];c(f).each(function(){var e=c(this);e.is(":checked")&&n.push(e.val())}),t=n,o="",a.get_strings([{key:"confirm",component:"moodle"},{key:"confirmcontextdeletion",component:"tool_dataprivacy"}]).then(function(e){o=e[0];e=e[1];return s.create({title:o,body:e,type:s.types.SAVE_CANCEL})}).then(function(e){return e.setSaveButtonText(o),e.getRoot().on(d.save,function(){i.call([{methodname:"tool_dataprivacy_confirm_contexts_for_deletion",args:{ids:t}}])[0].done(function(e){e.result?window.location.reload():r.addNotification({message:e.warnings[0].message,type:"error"})}).fail(r.exception)}),e.getRoot().on(d.hidden,function(){e.destroy()}),e}).done(function(e){e.show()}).fail(r.exception)}),c(o).change(function(e){e.preventDefault(),c(this).is(":checked")?c(f).attr("checked","checked"):c(f).removeAttr("checked")})},e});