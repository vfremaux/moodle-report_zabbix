define(["jquery","core/log","core/config"],function(m,i,s){var g={component:"mod_learningtimecheck",shortcomponent:"learningtimecheck",componentpath:"mod/learningtimecheck",init:function(){var e="#id_s_"+g.shortcomponent+"_licensekey";m(e).bind("change",this.check_product_key),m(e).trigger("change"),i.debug("AMD Pro js initialized for "+g.component+" system")},check_product_key:function(){var i="#id_s_"+g.shortcomponent+"_licensekey",e=m(this),o=e.val().replace(/-/g,""),r=o.substr(0,14),o=o.substr(14,2),r=g.checksum(r),t=' <img src="'+s.wwwroot+'/pix/i/valid.png">',n=' <img src="'+s.wwwroot+'/pix/i/warning.png">',c=' <img src="'+s.wwwroot+'/pix/i/invalid.png">',a=' <img src="'+s.wwwroot+'/pix/i/ajaxloader.gif">';o===r?(o=(o=(o=s.wwwroot+"/"+g.componentpath+"/pro/ajax/services.php?what=license&service=check")+"&customerkey="+e.val())+"&provider="+m("#id_s_"+g.shortcomponent+"_licenseprovider").val(),m(i+" + img").remove(),m(i).after(a),m.get(o,function(e){e.match(/(SET|CHECK) OK/)?e.match(/-\d+.*$/)?(m(i+" + img").remove(),m(i).after(n)):(m(i+" + img").remove(),m(i).after(t)):(m(i+" + img").remove(),m(i).after(c))},"html")):(m(i+" + img").remove(),m(i).after(n))},checksum:function(e){var i,o="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),r=o.length,t=e.split(""),n=0;for(i in t)n+=t[i].charCodeAt(0);e=Math.floor(n/r)%r;return""+o[n%r]+o[e]}};return g});