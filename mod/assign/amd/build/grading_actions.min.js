define(["jquery","mod_assign/grading_events"],function(t,e){function n(e){this._regionSelector=e,this._region=t(e),this.registerEventListeners()}return n.prototype._regionSelector=null,n.prototype._lastUserId=0,n.prototype._region=null,n.prototype._showActionsForm=function(e,t){var n=this._region.find("[data-region=grading-actions-form]");t!=this._lastUserId&&0<t&&(this._lastUserId=t),0<t?n.removeClass("hide"):n.addClass("hide")},n.prototype._trigger=function(e){t(document).trigger(e)},n.prototype.getReviewPanelElement=function(){return t('[data-region="review-panel"]')},n.prototype.hasReviewPanelElement=function(){return 0<this.getReviewPanelElement().length},n.prototype.getCollapseGradePanelButton=function(){return t('[data-region="grade-actions"] .collapse-grade-panel')},n.prototype.getCollapseReviewPanelButton=function(){return t('[data-region="grade-actions"] .collapse-review-panel')},n.prototype.getExpandAllPanelsButton=function(){return t('[data-region="grade-actions"] .collapse-none')},n.prototype.resetLayoutButtons=function(){this.getCollapseGradePanelButton().removeClass("active"),this.getCollapseReviewPanelButton().removeClass("active"),this.getExpandAllPanelsButton().removeClass("active")},n.prototype.collapseReviewPanel=function(){t(document).trigger(e.COLLAPSE_REVIEW_PANEL),t(document).trigger(e.EXPAND_GRADE_PANEL),this.resetLayoutButtons(),this.getCollapseReviewPanelButton().addClass("active")},n.prototype.collapseGradePanel=function(){t(document).trigger(e.COLLAPSE_GRADE_PANEL),t(document).trigger(e.EXPAND_REVIEW_PANEL),this.resetLayoutButtons(),this.getCollapseGradePanelButton().addClass("active")},n.prototype.expandAllPanels=function(){t(document).trigger(e.EXPAND_GRADE_PANEL),t(document).trigger(e.EXPAND_REVIEW_PANEL),this.resetLayoutButtons(),this.getExpandAllPanelsButton().addClass("active")},n.prototype.registerEventListeners=function(){var e;this.hasReviewPanelElement()&&((e=this.getCollapseReviewPanelButton()).click(function(e){this.collapseReviewPanel(),e.preventDefault()}.bind(this)),e.keydown(function(e){e.metaKey||e.shiftKey||e.altKey||e.ctrlKey||13!==e.keyCode&&32!==e.keyCode||(this.collapseReviewPanel(),e.preventDefault())}.bind(this)),(e=this.getCollapseGradePanelButton()).click(function(e){this.collapseGradePanel(),e.preventDefault()}.bind(this)),e.keydown(function(e){e.metaKey||e.shiftKey||e.altKey||e.ctrlKey||13!==e.keyCode&&32!==e.keyCode||(this.collapseGradePanel(),e.preventDefault())}.bind(this)),(e=this.getExpandAllPanelsButton()).click(function(e){this.expandAllPanels(),e.preventDefault()}.bind(this)),e.keydown(function(e){e.metaKey||e.shiftKey||e.altKey||e.ctrlKey||13!==e.keyCode&&32!==e.keyCode||(this.expandAllPanels(),e.preventDefault())}.bind(this))),t(document).on("user-changed",this._showActionsForm.bind(this)),this._region.find('[name="savechanges"]').on("click",this._trigger.bind(this,"save-changes")),this._region.find('[name="saveandshownext"]').on("click",this._trigger.bind(this,"save-and-show-next")),this._region.find('[name="resetbutton"]').on("click",this._trigger.bind(this,"reset")),this._region.find("form").on("submit",function(e){e.preventDefault()})},n});