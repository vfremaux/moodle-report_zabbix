define(["jquery","core/log","core/config"],function(r,t,l){return customboxcollapsed={init:function(){r(".custombox-collapsedtext-open-all").bind("click",this.openall),r(".custombox-collapsedtext-close-all").bind("click",this.closeall),r(".custombox-collapsedtext-toggle").bind("click",this.togglestate),r(".custombox-collapsedtext-caption").bind("click",this.togglestateproxy),t.debug("AMD customlabel collapsedtext initialized.")},openall:function(){var t=r(this).attr("id").replace("custombox-collapsedtext-open-all-",""),e=".custombox-collapsedtext-toggle-"+t,e=(r(".custombox-collapsedtext-panel-"+t).removeClass("collapsed"),r(e+" img").each(function(){var t=r(this).attr("src");r(this).attr("src",t.replace("closed","open"))}),l.wwwroot+"/mod/customlabel/type/collapsedtext/ajax/service.php");r.get(e+"?what=complete"+("&cmid="+t))},closeall:function(t){var e=r(this).attr("id").replace("custombox-collapsedtext-close-all-",""),o=".custombox-collapsedtext-toggle-"+e;r(".custombox-collapsedtext-panel-"+e).addClass("collapsed"),r(o+" img").each(function(){var t=r(this).attr("src");r(this).attr("src",t.replace("open","closed"))})},togglestate:function(t){var e,o=r(this),l=o.hasClass("is-toggle"),o=o.attr("id").replace("custombox-collapsedtext-toggle-",""),c=o.split("-"),s=c.shift(),c=c.shift(),a="#custombox-collapsedtext-toggle-"+o,o="#custombox-collapsedtext-panel-"+o,p=".custombox-collapsedtext-toggle-"+s,i=".custombox-collapsedtext-panel-"+s;l?r(o).hasClass("collapsed")?(r(o).removeClass("collapsed"),e=r(a+" img").attr("src"),r(a+" img").attr("src",e.replace("closed","open")),customboxcollapsed.sendcompletion(s,c)):(r(o).addClass("collapsed"),e=r(a+" img").attr("src"),r(a+" img").attr("src",e.replace("open","closed"))):(r(i).addClass("collapsed"),r(o).removeClass("collapsed"),customboxcollapsed.sendcompletion(s,c),r(p+" img").each(function(){var t=r(this).attr("src");r(this).attr("src",t.replace("open","closed"))}),e=r(a+" img").attr("src"),r(a+" img").attr("src",e.replace("closed","open"))),t.preventDefault()},togglestateproxy:function(){var t=r(this).attr("id").replace("custombox-collapsedtext-caption-","custombox-collapsedtext-toggle-");r("#"+t).trigger("click")},sendcompletion:function(t,e){var o=l.wwwroot+"/mod/customlabel/type/collapsedtext/ajax/service.php";r.get((o+="?what=open")+("&cmid="+t)+("&item="+e))}}});