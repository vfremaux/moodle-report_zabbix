define(["jquery","core/pubsub","core/str","core_message/message_drawer_events","core_message/message_drawer_view_contacts_section_contacts","core_message/message_drawer_view_contacts_section_requests"],function(c,_,t,T,i,C){var N={ACTION_SHOW_CONTACTS_SECTION:'[data-action="show-contacts-section"]',ACTION_SHOW_REQUESTS_SECTION:'[data-action="show-requests-section"]',CONTACT_REQUEST_COUNT:'[data-region="contact-request-count"]',CONTACTS_SECTION_CONTAINER:'[data-section="contacts"]',REQUESTS_SECTION_CONTAINER:'[data-section="requests"]'},E=function(t){return t.find(N.CONTACTS_SECTION_CONTAINER)},O=function(t){return t.find(N.REQUESTS_SECTION_CONTAINER)},S=function(s){return function(){var t=s.find(N.CONTACT_REQUEST_COUNT),e=parseInt(t.text(),10);(e=isNaN(e)?0:e-1)<=0?t.addClass("hidden"):t.text(e)}};return{show:function(t,e){(e=c(e)).attr("data-contacts-init")||(n=E(s=e),a=O(s),o=s.find(N.ACTION_SHOW_CONTACTS_SECTION),r=s.find(N.ACTION_SHOW_REQUESTS_SECTION),o.on("show.bs.tab",function(){i.show(n)}),r.on("show.bs.tab",function(){C.show(a)}),_.subscribe(T.CONTACT_REQUEST_ACCEPTED,S(s)),_.subscribe(T.CONTACT_REQUEST_DECLINED,S(s)),e.attr("data-contacts-init",!0));var s,n,a,o=E(e),r=O(e);return o.hasClass("active")?i.show(o):C.show(r),c.Deferred().resolve().promise()},description:function(){return t.get_string("messagedrawerviewcontacts","core_message")}}});