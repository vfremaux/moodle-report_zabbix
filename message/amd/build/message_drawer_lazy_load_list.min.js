define(["jquery","core/custom_interaction_events"],function(l,r){function t(n){n.attr("data-loading",!1)}function o(n,t){n.attr("data-loaded-all",t)}var d='[data-region="lazy-load-list"]',e='[data-region="loading-icon-container"]',h='[data-region="content-container"]',a='[data-region="empty-message-container"]',i='[data-region="placeholder-container"]',c=function(n){return n.find(h)},g=function(n){n.find(e).removeClass("hidden")},u=function(n){n.find(e).addClass("hidden")},s=function(n){n.find(a).removeClass("hidden")},m=function(n){n.find(i).removeClass("hidden")},C=function(n){n.find(i).addClass("hidden")},f=function(n){c(n).removeClass("hidden")},v=function(n){c(n).addClass("hidden")},y=function(n){return!("true"==n.attr("data-loaded-all")||"true"===n.attr("data-loading"))},p=function(e,n,a){var i=e.attr("data-user-id");return e.attr("data-loading",!0),n(e,i).then(function(n){var t;return 0<n.length?(t=c(e),a(t,n,i).then(function(){return n})):n}).then(function(n){return t(e),e.attr("data-seen",!0),n.length||o(e,!0),n}).catch(function(){t(e),e.attr("data-seen",!0)})};return{show:function(n,t,e){var a,i,o,d;(n=l(n)).attr("data-init")||(i=n,o=t,d=e,r.define(i,[r.events.scrollBottom]),i.on(r.events.scrollBottom,function(){y(i)&&(g(i),p(i,o,d).then(function(){return u(i)}).catch(function(){return u(i)}))}),t=t,e=e,c(a=n).empty(),m(a),v(a),p(a,t,e).then(function(n){C(a),(n.length?f:s)(a)}).catch(function(){C(a),f(a)}),n.attr("data-init",!0))},getContentContainer:c,getRoot:function(n){return n.find(d)},setLoadedAll:o,showEmptyMessage:s,hideEmptyMessage:function(n){n.find(a).addClass("hidden")},showContent:f,hideContent:v}});