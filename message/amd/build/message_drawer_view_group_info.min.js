define(["jquery","core/str","core/templates","core_message/message_repository","core_message/message_drawer_lazy_load_list"],function(i,r,s,u,c){function _(n,e){return s.render(g.MEMBERS_LIST,{contacts:e}).then(function(e){return n.append(e),e})}var n={CONTENT_CONTAINER:'[data-region="group-info-content-container"]',MEMBERS_LIST:'[data-region="members-list"]'},g={CONTENT:"core_message/message_drawer_view_group_info_body_content",MEMBERS_LIST:"core_message/message_drawer_view_group_info_participants_list"},m=function(e){return e.find(n.CONTENT_CONTAINER)};return{show:function(r,a,e){return r=i(r),m(r).empty(),n=r,e=e,o=50<(t=a).totalMemberCount?50:t.totalMemberCount,o=Array.apply(null,Array(o)).map(function(){return!0}),t={name:t.name,subname:t.subname,imageurl:t.imageUrl,placeholders:o,loggedinuser:{id:e}},s.render(g.CONTENT,t).then(function(e){return m(n).append(e),e}).then(function(){var e,t,o,n=c.getRoot(r);c.show(n,(e=a,t=50,o=0,function(n,r){return u.getConversationMembers(e.id,r,t+1,o).then(function(e){return e.length>t?e=e.slice(0,-1):c.setLoadedAll(n,!0),o+=t,e.filter(function(e){return e.id!=r})})}),_)});var n,t,o},description:function(e,n){return r.get_string("messagedrawerviewgroupinfo","core_message",n.name)}}});