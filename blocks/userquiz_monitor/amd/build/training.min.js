define(["jquery","core/config","core/log"],function(r,s,l){var d,o,n,p,u,a={init:function(e,t,i,a,c){d=e,o=t,u=i,n=a,p=c,r(".cb-master").prop("disabled",!1),r(".cb-master").prop("checked",!1),r("#checkall-master").prop("disabled",!1),r("#checkall-master").prop("checked",!1),r("#checkall-master").bind("change",this.select_all_master_categories),r(".cb-master").bind("click",this.update_selector_master_global),r(".userquiz-monitor-cat-button").bind("click",this.fetch_training_subcategories),r(".userquiz-monitor-cat-button").addClass("active"),r(".userquiz-monitor-exam-cat-button").bind("click",this.fetch_exam_subcategories),r(".userquiz-monitor-exam-cat-button").addClass("active"),l.debug("AMD Block_userquiz_monitor quizforceanswer initialized")},init_detail:function(){var e=r(this).attr("id").match(/[^0-9]*([0-9]+)$/)[1];r("#id-checkall-detail-"+e).prop("checked",!1),r("#id-checkall-detail-"+e).bind("change",this.select_all_detail_categories),r(".cb-detail-"+e).prop("checked",!1),r(".cb-detail-"+e).bind("click",this.update_selector_detail),l.debug("AMD Block_userquiz_monitor detail "+e+" initialized")},update_selector_master_ajax:function(){var e=r(this),t=(t=parseInt(e.attr("id").replace("id-cb-master-","")))||parseInt(e.attr("id").replace("details-button-","")),i="courseid="+d+"&rootcategory="+u+"&categoryid="+t,i=(i+="&location=mode0&quizlist="+n,M.cfg.wwwroot+"/blocks/userquiz_monitor/ajax/updateselector.php?"+i);e.prop("checked")&&r(".cb-detail-"+t).prop("checked",!0),r.get(i,function(e){r(".selectorcontainers").html(e),r("#id-selector-nb-questions").length?r("#id-training-go-button").prop("disabled",!1):r("#id-training-go-button").prop("disabled",!0)},"html")},update_selector_master_global:function(e){var t="",e=("all"===e&&this.select_all_master_cb(),r(".cb-master").each(function(){var e;r(this).prop("checked")&&(e=r(this).attr("id").replace("id-cb-master-",""),t=""===t?e:t+","+e)}),"courseid="+d+"&rootcategory="+u+"&categoryid="+(t=""===t?"null":t)),e=(e+="&location=mode0&quizlist="+n,M.cfg.wwwroot+"/blocks/userquiz_monitor/ajax/updateselector.php?"+e);r.get(e,function(e){r(".selectorcontainers").html(e),r("#id-selector-nb-questions").length?r("#id-training-go-button").prop("disabled",!1):r("#id-training-go-button").prop("disabled",!0)},"html")},update_selector_detail:function(){l.debug("update_selector_detail");var e,t="",i=!0,a=0,c=this.className.split(" ");for(e in c)c[e].match(/^cb-detail-/)&&(a=c[e].replace("cb-detail-",""));r(".cb-detail").each(function(){var e=r(this).attr("id").replace("id-cb-detail-","");r(this).prop("checked")?t=""===t?e:t+","+e:i=!1}),!i&&a&&r("#id-cb-master-"+a).prop("checked",!1);var o="courseid="+d+"&rootcategory="+u+"&categoryid="+(t=""===t?"null":t),o=(o+="&location=mode1&quizlist="+n,s.wwwroot+"/blocks/userquiz_monitor/ajax/updateselector.php?"+o);r.get(o,function(e){r(".selectorcontainers").html(e),r("#id-selector-nb-questions").length?r("#id-training-go-button").prop("disabled",!1):r("#id-training-go-button").prop("disabled",!0)},"html")},refresh_selector:function(){var e=r(this).attr("id").replace(),e="rootcategory="+u+"&categoryid="+e+"&quizzeslist="+n,e=s.wwwroot+"/blocks/userquiz_monitor/ajax/refreshselector.php?"+e;r.get(e,function(e){r(".selectorcontainers").html(e),r("#id-selector-nb-questions").length?r("#id-training-go-button").prop("disabled",!1):r("#id-training-go-button").prop("disabled",!0)},"html")},select_all_master_categories:function(){r("#checkall-master").prop("checked")?r(".cb-master").prop("checked",!0):r(".cb-master").prop("checked",!1),a.update_selector_master_global()},select_all_detail_categories:function(){var e=r(this),t=e.attr("id").replace("id-checkall-detail-","");e.prop("checked")?r(".cb-detail-"+t).prop("checked",!0):r(".cb-detail-"+t).prop("checked",!1),r.proxy(a.update_selector_detail,this)()},reset_training:function(e){e="id="+d+"&userid="+e+"&quizzeslist="+n,e=s.wwwroot+"/blocks/userquiz_monitor/ajax/resettraining.php?"+e;r.get(e,function(e){alert(e),window.location=s.wwwroot+"/course/view.php?id="+d},"html")},refresh_content:function(){var t=r(this).attr("id").replace("",""),e="courseid="+d+"&rootcategory="+u+"&id="+t,e=s.wwwroot+"/blocks/userquiz_monitor/ajax/schedulecontent.php?"+e;r.get(e,function(e){r("#divschedule").html(e),this.highlight_amf_cat(t)})},highlight_training_cat:function(e){r("trainingcat").removeClass("active"),r("trainingcat").addClass("inactive");for(var t=0;t<12;t++)t===e&&(r("#trainingcat"+t).removeClass("inactive"),r("#trainingcat"+t).addClass("active"))},close_detail:function(){var e=r(this).attr("id").replace("id-cancel-detail-","");r("#checkall-master").prop("checked",!1),r("#checkall-master").prop("disabled",!1),r(".cb-master").prop("checked",!1),r(".cb-master").prop("disabled",!1),r(".cb-master").addClass("trans100"),r(".cb-master").removeClass("trans50"),r("#id-detail-button-div-"+e).addClass("active"),r(".progressbar-container").css("visibility","visible"),r(".category-subpod").css("display","none"),r("#category-subcatpod-"+e).html(""),r(".cb-master").prop("disabled",!1),r(".div-main").removeClass("trans50"),r(".div-main").addClass("trans100"),r.proxy(a.update_selector_detail,this)()},fetch_training_subcategories:function(){var i=r(this).attr("id").replace("details-button-div-",""),e="blockid="+o+"&courseid="+d+"&rootcategory="+u,e=(e+="&categoryid="+i+"&quizzeslist="+n+"&mode=training",s.wwwroot+"/blocks/userquiz_monitor/ajax/subcategoriescontent.php?"+e);r.post(e,"",function(e){var t=isNaN(i)?i.replace("details-button-",""):i;r(".category-subpod").css("display","none"),r("#category-subcatpod-"+i).html(""),r("#category-subcatpod-"+t).html(e),r("#category-subcatpod-"+t).css("display","inline-block"),l.debug("AMD Block_userquiz_monitor detail "+t+" loaded"),r("#id-checkall-detail-"+i).prop("checked",!1),r("#id-checkall-detail-"+i).bind("change",a.select_all_detail_categories),r("#id-cb-master-"+i).prop("checked")?(r("#id-checkall-detail-"+i).prop("checked",!0),r(".cb-detail-"+i).prop("checked",!0)):(r("#id-checkall-detail-"+i).prop("checked",!1),r(".cb-detail-"+i).prop("checked",!1)),r(".cb-detail-"+i).bind("click",a.update_selector_detail),r("#id-cancel-detail-"+i).bind("click",a.close_detail),r("#id-detail-button-div-"+i).removeClass("active"),r(".cb-master").prop("disabled",!0),r(".cb-master").prop("checked",!1),r(".div-main").addClass("trans50"),r(".div-main").removeClass("trans100"),r("#cb-master-"+i).prop("disabled",!1),r("#id-div-main-"+i).removeClass("trans50"),r("#id-div-main-"+i).addClass("trans100"),r("html,body").animate({scrollTop:r("#id-cat-"+i).offset().top},"slow"),r.proxy(a.update_selector_detail,this)()},"html")},fetch_exam_subcategories:function(){var i=r(this).attr("id").replace("details-button-div-",""),e="blockid="+o+"&courseid="+d+"&rootcategory="+u,e=(e+="&categoryid="+i+"&quizzeslist="+p+"&mode=exam",s.wwwroot+"/blocks/userquiz_monitor/ajax/subcategoriescontent.php?"+e);r.post(e,"",function(e){var t=isNaN(i)?i.replace("details-button-",""):i;r(".category-subpod").css("display","none"),r("#category-subcatpod-"+i).html(""),r("#category-subcatpod-"+t).html(e),r("#category-subcatpod-"+t).css("display","inline-block"),l.debug("AMD Block_userquiz_monitor detail "+t+" loaded"),r("#id-cancel-detail-"+i).bind("click",a.close_detail),r("#id-detail-button-div-"+i).removeClass("active"),r(".div-main").addClass("trans50"),r(".div-main").removeClass("trans100"),r("#id-div-main-"+i).removeClass("trans50"),r("#id-div-main-"+i).addClass("trans100"),r("html,body").animate({scrollTop:r("#id-cat-"+i).offset().top},"slow")},"html")}};return a});