define(["jquery","core/config","core/log"],function(c,s,n){var l={currentcourseid:0,init:function(e){c(".block_multicourse_navigation .node-course .handle").on("click",this.togglecoursestate),n.debug("Block course modulenavigation course control initialized"),c(".block_multicourse_navigation .node-section .handle").on("click",this.togglesectionstate),n.debug("Block course modulenavigation section control initialized"),c(".multicourse-controls").on("click",this.processglobal),l.currentcourseid=e},processglobal:function(e){e.stopPropagation(),e.preventDefault();var e=c(this),e=/multicourse-([a-z]+)-(\d+)/.exec(e.attr("id")),i=e[1],t=e[2],e=(e=s.wwwroot+"/blocks/multicourse_navigation/ajax/service.php?")+("blockid="+t)+("&what="+i);switch(i){case"collapseall":c(".section-content.block-"+t).css("display","none"),c(".section-content.block-"+t).css("visibility","hidden");break;case"expandall":c(".section-content.block-"+t).css("display","block"),c(".section-content.block-"+t).css("visibility","visible");break;case"showmodules":c(".section-content.block-"+t+" .activities").css("display","block"),c(".section-content.block-"+t+" .activities").css("visibility","visible");break;case"hidemodules":c(".section-content.block-"+t+" .activities").css("display","none"),c(".section-content.block-"+t+" .activities").css("visibility","hidden")}c.get(e)},togglecoursestate:function(e){e.stopPropagation(),e.preventDefault();var i,t,o,e=c(this),e=(n.debug("Courseid "+l.currentcourseid),n.debug("Elm "+e.parent().attr("id")),/node-course-([0-9]+)-block-([0-9]+)/.exec(e.parent().attr("id")));if(e)return o=parseInt(e[1]),e=parseInt(e[2]),n.debug("Working for block "+e+" in course "+o),i=s.wwwroot+"/blocks/multicourse_navigation/ajax/stateregister.php?",i=(i=i+"id="+l.currentcourseid+"&item=course")+"&itemid="+o+"&blockid="+e,t=c("#node-course-"+o+"-block-"+e+" .handle > img").attr("src"),o="visible"===c("#course-content-"+o).css("visibility")?(c("#course-content-"+o).css("visibility","hidden"),c("#course-content-"+o).css("display","none"),t=t.replace("expanded","collapsed"),c("#node-course-"+o+"-block-"+e+" .handle > img").attr("src",t),1):(c("#course-content-"+o).css("visibility","visible"),c("#course-content-"+o).css("display","block"),t=t.replace("collapsed","expanded"),c("#node-course-"+o+"-block-"+e+" .handle > img").attr("src",t),0),c.get(i+="&hide="+o,function(){}),!1},togglesectionstate:function(e){e.stopPropagation(),e.preventDefault();var i,t,o,e=c(this),e=(n.debug("Courseid "+l.currentcourseid),n.debug("Elm "+e.parent().attr("id")),/node-block-([0-9]+)-section-([0-9]+)/.exec(e.parent().attr("id")));if(e)return o=parseInt(e[1]),e=parseInt(e[2]),n.debug("Working for block "+o+" and section "+e),i=s.wwwroot+"/blocks/multicourse_navigation/ajax/stateregister.php?",i=(i=i+"id="+l.currentcourseid+"&item=section")+"&itemid="+e+"&blockid="+o,t=c("#node-block-"+o+"-section-"+e+" .handle > img").attr("src"),o="visible"===c("#section-content-"+e).css("visibility")?(c("#section-content-"+e).css("visibility","hidden"),c("#section-content-"+e).css("display","none"),t=t.replace("expanded","collapsed"),c("#node-block-"+o+"-section-"+e+" .handle > img").attr("src",t),1):(c("#section-content-"+e).css("visibility","visible"),c("#section-content-"+e).css("display","block"),t=t.replace("collapsed","expanded"),c("#node-block-"+o+"-section-"+e+" .handle > img").attr("src",t),0),c.get(i+="&hide="+o,function(){}),!1}};return l});