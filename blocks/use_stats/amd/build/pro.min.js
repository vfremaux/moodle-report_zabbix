define(["jquery","core/log","core/config"],function(a,o,m){var p={component:"block_use_stats",shortcomponent:"block_use_stats",componentpath:"blocks/use_stats",init:function(){var e="#id_s_"+p.component+"_licensekey";a(e).bind("change",this.check_product_key),a(e).trigger("change"),o.debug("AMD Pro js initialized for "+p.component+" system")},check_product_key:function(){var o="#id_s_"+p.component+"_licensekey",e=a(this),t=e.val().replace(/-/g,""),i=t.substr(0,14),t=t.substr(14,2),i=p.checksum(i),r=' <img src="'+m.wwwroot+'/pix/i/valid.png">',c=' <img src="'+m.wwwroot+'/pix/i/warning.png">',n=' <img src="'+m.wwwroot+'/pix/i/invalid.png">',s=' <img src="'+m.wwwroot+'/pix/i/ajaxloader.gif">';t===i?(t=(t=(t=m.wwwroot+"/"+p.componentpath+"/pro/ajax/services.php?what=license&service=check")+"&customerkey="+e.val())+"&provider="+a("#id_s_"+p.component+"_licenseprovider").val(),a(o+" + img").remove(),a(o).after(s),a.get(t,function(e){e.match(/(SET|CHECK) OK/)?e.match(/-\d+.*$/)?(a(o+" + img").remove(),a(o).after(c)):(a(o+" + img").remove(),a(o).after(r)):(a(o+" + img").remove(),a(o).after(n))},"html")):(a(o+" + img").remove(),a(o).after(c))},checksum:function(e){var o,t="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),i=t.length,r=e.split(""),c=0;for(o in r)c+=r[o].charCodeAt(0);e=Math.floor(c/i)%i;return""+t[c%i]+t[e]}};return p});