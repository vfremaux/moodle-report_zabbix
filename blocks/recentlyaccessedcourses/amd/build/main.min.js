define(["jquery","core_course/repository","core/templates","core/notification","core/pubsub","core_course/events"],function(t,c,o,s,u,i){var a={COURSES_VIEW:'[data-region="recentlyaccessedcourses-view"]',COURSES_VIEW_CONTENT:'[data-region="recentlyaccessedcourses-view-content"]'},d=10,f=function(e,r){return c.getLastAccessedCourses(e,r)},E=function(e,r){return 0<r.length?o.render("block_recentlyaccessedcourses/view-cards",{courses:r}):(r=e.attr("data-nocoursesimgurl"),o.render("block_recentlyaccessedcourses/no-courses",{nocoursesimgurl:r}))},l=function(e,r){var c=r.find(a.COURSES_VIEW),n=r.find(a.COURSES_VIEW_CONTENT),t=f(e,d);return t.then(function(e){return E(c,e).then(function(e,r){return o.replaceNodeContents(n,e,r)}).catch(s.exception),t}).catch(s.exception)};return{init:function(e,r){var c,n;r=t(r),c=e,n=r,u.subscribe(i.favourited,function(){l(c,n)}),u.subscribe(i.unfavorited,function(){l(c,n)}),l(e,r)}}});