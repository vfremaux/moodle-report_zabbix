define(["jquery","core/ajax"],function(o,i){return{loadFragment:function(e,t,r,n){var c=o.Deferred();return function(e,t,r,n){var a,c=[];for(a in n)c.push({name:a,value:n[a]});return i.call([{methodname:"core_get_fragment",args:{component:e,callback:t,contextid:r,args:c}}])[0]}(e,t,r,n).then(function(e){var t=o(e.javascript),a="";t.each(function(e,r){var n,t=(r=o(r)).prop("tagName");t&&"script"==t.toLowerCase()&&(r.attr("src")?(n=!1,o("script").each(function(e,t){return!(n=o(t).attr("src")==r.attr("src")?!0:n)}),n||(a=(a+=' {  node = document.createElement("script");  node.type = "text/javascript"; ')+' node.src = decodeURI("'+encodeURI(r.attr("src"))+'");  document.getElementsByTagName("head")[0].appendChild(node);  } ')):a+=" "+r.text())}),c.resolve(e.html,a)}).fail(function(e){c.reject(e)}),c.promise()}}});