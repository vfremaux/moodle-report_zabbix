define(["jquery","core/custom_interaction_events","core/paged_content_events","core/pubsub"],function(r,n,i,s){function a(t){return parseInt(t.attr("data-page-number"),10)}function o(t){return t.find(f.DROPDOWN_ITEM)}function u(t){return parseInt(t.attr("data-item-count"),10)}function c(t,n,e){var a=d(t,n).add(n),a=p(t,a),r=t.find(f.DROPDOWN_TOGGLE),o=r.find(f.CARET);O(t).removeClass("active"),n.addClass("active"),r.html(n.text()),r.append(o),s.publish(e+i.SHOW_PAGES,a)}var f={ROOT:'[data-region="paging-dropdown-container"]',DROPDOWN_ITEM:'[data-region="dropdown-item"]',DROPDOWN_TOGGLE:'[data-region="dropdown-toggle"]',ACTIVE_DROPDOWN_ITEM:'[data-region="dropdown-item"].active',CARET:'[data-region="caret"]'},d=function(t,n){var e=a(n);return o(t).filter(function(t,n){return a(r(n))<e})},O=function(t){return t.find(f.ACTIVE_DROPDOWN_ITEM)},p=function(e,t){return t.map(function(t,n){return n=r(n),{pageNumber:a(n),limit:u(n),offset:function(t,n){if(null!=n.attr("data-offset"))return parseInt(n.attr("data-offset"),10);var e=0;return d(t,n).each(function(t,n){n=r(n),e+=u(n)}),n.attr("data-offset",e),e}(e,n)}}).get()};return{init:function(e,a){e=r(e);o(e).each(function(t,n){(n=r(n)).attr("data-page-number",t+1)});var t=O(e);t.length&&c(e,t,a),n.define(e,[n.events.activate]),e.on(n.events.activate,f.DROPDOWN_ITEM,function(t,n){t=r(t.target).closest(f.DROPDOWN_ITEM);c(e,t,a),n.originalEvent.preventDefault()})},rootSelector:f.ROOT}});