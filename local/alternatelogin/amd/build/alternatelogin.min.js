define(["jquery","core/config","core/log"],function(i,n,e){var a={init:function(){i(".alternate-profile-choice").bind("click",this.togglechoice),i("#back-step-1").bind("click",this.switchtopanel1),i("#next-step-2").bind("click",this.switchtopanel2),i("#next-step-3").bind("click",this.send),i(".field-cpy-check input").bind("keyup",this.checkfieldcopy),i("input.field-non-empty-input").bind("keyup",this.checknonempty),i("select.field-non-empty-input").bind("change",this.checknonempty),i("#id-field-authcode-input").bind("change",this.checkauthcode),i(".field-cpy-check input").trigger("keyup"),i("input.field-non-empty-input").trigger("keyup"),i("select.field-non-empty-input").trigger("change"),i("#readmore").trigger("open"),a.updatebutton3state(),e.debug("AMD alternate login initialized")},togglechoice:function(){var e=i(this),t=e.attr("id").match(/pv-choice-btn-(\d+)-(\d+)/)[1];i(".alternate-profile-choice").removeClass("selected"),i(".alternate-profile-field").val(""),e.addClass("selected"),i("#pv-"+t).val(e.attr("data-value")),i("#pv-"+t).removeClass("unchecked"),a.updatebutton3state()},checknonempty:function(){var e=i(this);""!==e.val()?e.removeClass("unchecked"):e.addClass("unchecked"),a.updatebutton2state(),a.updatebutton3state()},checkauthcode:function(){var e=i(this),t=n.wwwroot+"/local/alternatelogin/ajax/service.php",t=(t+="?what=checkcode")+("&code="+e.val());i.get(t,function(e){1===e.result?i("#id-field-authcode-field").removeClass("error"):i("#id-field-authcode-field").addClass("error")},"json")},switchtopanel2:function(){i("#sign-up-panel-1").addClass("hidden"),i("#sign-up-panel-2").removeClass("hidden")},switchtopanel1:function(){i("#sign-up-panel-1").removeClass("hidden"),i("#sign-up-panel-2").addClass("hidden")},send:function(){i("form[name=signup-form]").submit()},checkfieldcopy:function(){var e=i(this).attr("name").replace("confirm",""),t=e+"confirm",n=i("input[name="+e+"]").val(),t=i("input[name="+t+"]").val(),c=i("#"+e+"-field-cpy-check img").attr("src");n===t&&""!==n?(i("."+e+"-field-cpy-check img").attr("src",c.replace(/\bnook$/,"ok")),i("."+e+"-field-cpy-check img").attr("src",c.replace(/\bnook$/,"ok")),i("."+e+"-field-cpy-check").removeClass("unchecked")):(i("."+e+"-field-cpy-check img").attr("src",c.replace(/\bok$/,"/nook")),i("."+e+"-field-cpy-check img").attr("src",c.replace(/\bok$/,"=nook")),i("."+e+"-field-cpy-check").addClass("unchecked")),a.updatebutton2state()},updatebutton2state:function(){0===i("#sign-up-panel-1 .unchecked").length?i("#next-step-2").prop("disabled",!1):i("#next-step-2").prop("disabled",!0)},updatebutton3state:function(){0===i("#sign-up-panel-2 .unchecked").length?i("#next-step-3").prop("disabled",!1):i("#next-step-3").prop("disabled",!0)}};return a});