define(["jquery","core/log","core/config"],function(t,i,n){return{init:function(){t(".openmodal-activitychooser-link").bind("click",this.opendialog),t(".filter-section .filter").bind("click",this.filter),t(".openhelp").bind("click",this.openhelp),t(".back-selector").bind("click",this.goback),i.debug("AMD local userequipment modchooser initialized")},opendialog:function(e){sectionid=t(this).attr("data-sectionid"),sectionnum=t(this).attr("data-sectionnum"),console.log(sectionid+"/"+sectionnum),t(".add-module-link").each(function(){this.href=this.href.replace(/section=[0-9]+/,"section="+sectionnum),this.href=this.href.replace(/sr=[0-9]+/,"sr="+sectionnum)})},filter:function(e){e.stopPropagation(),e.preventDefault(),catid=parseInt(t(this).attr("data-category")),i.debug("Catid : "+catid),i.debug("Hasclass : "+t(this).hasClass("selected")),i.debug("Testcat : "+(0===catid)),t(this).hasClass("selected")||0===catid?(i.debug("Defiltering "),t(this).removeClass("selected"),t(".filter").css("opacity","unset"),t(".activity-element").removeClass("decline")):(i.debug("Filtering "),t(".filter").removeClass("selected"),t(this).addClass("selected"),t(".filter").css("opacity",.2),t(this).css("opacity","unset"),t(".activity-element").not(".cat-"+catid).addClass("decline"),t(".activity-element").not(".cat-"+catid),t(".activity-element.cat-"+catid).removeClass("decline"),t(".activity-element.cat-"+catid))},openhelp:function(e){e.stopPropagation(),e.preventDefault(),t(".carousel-item").fadeIn(),t(".main-section").hide(),t(".filter-section").hide(),pluginname=t(this).attr("data-value"),pluginlink=t(this).attr("data-link"),sectionlink="&section="+sectionnum,pluginlink=pluginlink.replace(/&amp;/g,"&"),sectionlink=sectionlink.replace(/&amp;/g,"&");e=n.wwwroot+"/local/userequipment/ajax/service.php",e=(e+="?what=gethelp")+"&modname="+pluginname;t.get(e,function(e){i.debug("Loading help topic"),t("#optionsummary-label").html(e.image+" "+e.label),t("#optionsummary-desc").html(e.help)},"json"),t(".addoption").attr("href",pluginlink+sectionlink)},goback:function(e){e.stopPropagation(),e.preventDefault(),t(".carousel-item").hide(),t(".main-section").fadeIn(),t(".filter-section").fadeIn()}}});