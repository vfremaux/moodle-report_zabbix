define(["jquery","core/str","core/notification","core_calendar/selectors","core_calendar/events","core_calendar/view_manager","core_calendar/repository","core/modal_factory","core_calendar/modal_event_form","core/modal_events","core_calendar/crud"],function(t,e,c,i,a,d,n,r,o,s,l){return{init:function(e,n){var o,r;e=t(e),d.init(e,n),o=e,e=n,n=t("body"),l.registerRemove(o),r="reloadCurrent"+e.charAt(0).toUpperCase()+e.slice(1),n.on(a.created,function(){d[r](o)}),n.on(a.deleted,function(){d[r](o)}),n.on(a.updated,function(){d[r](o)}),o.on("change",i.courseSelector,function(){var e=t(this).val();d[r](o,e,null).then(function(){return o.find(i.courseSelector).val(e)}).then(function(){window.history.pushState({},"","?view=upcoming&course="+e)}).fail(c.exception)}),n.on(a.filterChanged,function(e,n){var r=o.find(i.eventType[n.type]);1==n.hidden?r.addClass("hidden"):r.removeClass("hidden")}),e=l.registerEventFormModal(o),l.registerEditListeners(o,e)}}});