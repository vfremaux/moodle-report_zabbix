define(["jquery","core/custom_interaction_events","core/log"],function(s,a,e){function t(){s(r).length||e.debug("Page is missing a spdrawer region"),s(o).length||e.debug("Page is missing a spdrawer toggle link"),s(r).each(function(e,t){var t=s(t).find(o),a=t.attr("aria-controls"),a=s(document.getElementById(a)),r="false"==t.attr("aria-expanded"),i=t.attr("data-side"),n=s(d);a.on("mousewheel DOMMouseScroll",this.preventPageScroll),r?t.attr("aria-expanded","false"):(n.addClass("spdrawer-open-"+i),t.attr("aria-expanded","true"))}.bind(this)),this.registerEventListeners(),s(document).width()<768&&this.closeAll()}var r='[data-region="spdrawer-toggle"]',o='[data-action="toggle-spdrawer"]',d="body",i='.list-group-item[href*="#section-"]';return t.prototype.closeAll=function(){s(r).each(function(e,t){var t=s(t).find(o),a=t.attr("data-side"),r=s(d),i=t.attr("aria-controls"),i=s(document.getElementById(i)),n=t.attr("data-preference");t.attr("aria-expanded","false"),r.removeClass("drawer-open-"+a),i.attr("aria-hidden","true"),i.addClass("closed"),M.util.set_user_preference(n,"false")})},t.prototype.toggleDrawer=function(e){var e=s(e.target).closest("[data-action=toggle-spdrawer]"),t=e.attr("aria-controls"),t=s(document.getElementById(t)),a=s(d),r=e.attr("data-side"),i=e.attr("data-preference");a.addClass("drawer-ease"),"true"==e.attr("aria-expanded")?(a.removeClass("drawer-open-"+r),e.attr("aria-expanded","false"),t.attr("aria-hidden","true"),t.addClass("closed"),e.children("i").removeClass("fa-arrow-right"),e.children("i").addClass("fa-arrow-left"),M.util.set_user_preference(i,"false")):(e.attr("aria-expanded","true"),t.attr("aria-hidden","false"),t.focus(),a.addClass("drawer-open-"+r),t.removeClass("closed"),e.children("i").removeClass("fa-arrow-left"),e.children("i").addClass("fa-arrow-right"),M.util.set_user_preference(i,"true"))},t.prototype.preventPageScroll=function(e){var t=e.wheelDelta||e.originalEvent&&e.originalEvent.wheelDelta||-e.originalEvent.detail,a=0<=this.scrollTop+s(this).outerHeight()-this.scrollHeight,r=this.scrollTop<=0;(t<0&&a||0<t&&r)&&e.preventDefault()},t.prototype.registerEventListeners=function(){s(o).each(function(e,t){a.define(s(t),[a.events.activate]),s(t).on(a.events.activate,function(e,t){this.toggleDrawer(t.originalEvent),t.originalEvent.preventDefault()}.bind(this))}.bind(this)),s(i).click(function(){s(document).width()<768&&this.closeAll()}.bind(this))},{init:function(){return new t}}});