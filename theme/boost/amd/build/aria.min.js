define(["jquery","core/pending"],function(d,t){return{init:function(){function a(e){e=function(e){d(this).focus(),e.resolve()}.bind(e),setTimeout(e,50,new t("core/aria:delayed-focus"))}var o=!1;d('[data-toggle="dropdown"]').keydown(function(e){var t,n=e.which||e.keyCode;38==n&&(o=!0),27==n&&(t=d(e.target).attr("aria-expanded"),e.preventDefault(),"false"==t&&d(e.target).click()),32!=n&&13!=n||(e.preventDefault(),d(e.target).click())});d(".dropdown").on("shown.bs.dropdown",function(e){var e=d(e.target).find('[role="menu"]'),t=!1,n=!1;(t=e?d(e).find('[role="menuitem"]'):t)&&0<t.length&&(e=o,o=!1,n=e?t[t.length-1]:t[0]),n&&a(n)}),d('.dropdown [role="menu"] [role="menuitem"]').keypress(function(e){var t,n,o=String.fromCharCode(e.which||e.keyCode),e=d(e.target).closest('[role="menu"]'),r=0;if(e&&(t=d(e).find('[role="menuitem"]')))for(o=o.toLowerCase(),r=0;r<t.length;r++)if(0==(n=d(t[r])).text().trim().toLowerCase().indexOf(o)){a(n);break}}),d('.dropdown [role="menu"] [role="menuitem"]').keydown(function(e){var t,n=e.which||e.keyCode,o=!1,r=d(e.target).closest('[role="menu"]'),i=0;if(r&&(t=d(r).find('[role="menuitem"]'))){if(40==n){for(i=0;i<t.length-1;i++)if(t[i]==e.target){o=t[i+1];break}o=o||t[0]}else if(38==n){for(i=1;i<t.length;i++)if(t[i]==e.target){o=t[i-1];break}o=o||t[t.length-1]}else 36==n?o=t[0]:35==n&&(o=t[t.length-1]);o&&(e.preventDefault(),a(o))}}),d(".dropdown").on("hidden.bs.dropdown",function(e){e=d(e.target).find('[data-toggle="dropdown"]');e&&a(e)}),d(function(){window.setTimeout(function(e){var t=d('[role="alert"][data-aria-autofocus="true"]');0<t.length&&(d(t[0]).attr("tabindex","0"),d(t[0]).focus()),e.resolve()},300,new t("core/aria:delayed-focus"))})}}});