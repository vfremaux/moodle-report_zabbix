define(["jquery","core/custom_interaction_events","core/log"],function(o,a,e){function t(){o(r).length||e.debug("Page is missing a drawer region"),o(l).length||e.debug("Page is missing a drawer toggle link"),o(r).each(function(e,t){var t=o(t).find(l),a=t.attr("aria-controls"),a=o(document.getElementById(a)),r="false"==t.attr("aria-expanded"),n=t.attr("data-side"),i=o(d),s=t.attr("data-preference");c&&M.util.set_user_preference(s,"false"),a.on("mousewheel DOMMouseScroll",this.preventPageScroll),r?t.attr("aria-expanded","false"):(i.addClass("drawer-open-"+n),t.attr("aria-expanded","true"))}.bind(this)),this.registerEventListeners(),c&&this.closeAll()}var r='[data-region="drawer-toggle"]',l='[data-action="toggle-drawer"]',d="body",n='.list-group-item[href*="#section-"]',c=o(document).width()<768;return t.prototype.closeAll=function(){o(r).each(function(e,t){var t=o(t).find(l),a=t.attr("data-side"),r=o(d),n=t.attr("aria-controls"),n=o(document.getElementById(n)),i=t.attr("data-preference");t.attr("aria-expanded","false"),r.removeClass("drawer-open-"+a),n.attr("aria-hidden","true"),n.addClass("closed"),c||M.util.set_user_preference(i,"false")})},t.prototype.toggleDrawer=function(e){var e=o(e.target).closest("[data-action=toggle-drawer]"),t=e.attr("aria-controls"),t=o(document.getElementById(t)),a=o(d),r=e.attr("data-side"),n=e.attr("data-preference");c&&M.util.set_user_preference(n,"false"),a.addClass("drawer-ease"),"true"==e.attr("aria-expanded")?(a.removeClass("drawer-open-"+r),e.attr("aria-expanded","false"),t.attr("aria-hidden","true"),t.addClass("closed"),c||M.util.set_user_preference(n,"false")):(e.attr("aria-expanded","true"),t.attr("aria-hidden","false"),t.focus(),a.addClass("drawer-open-"+r),t.removeClass("closed"),c||M.util.set_user_preference(n,"true"))},t.prototype.preventPageScroll=function(e){var t=e.wheelDelta||e.originalEvent&&e.originalEvent.wheelDelta||-e.originalEvent.detail,a=0<=this.scrollTop+o(this).outerHeight()-this.scrollHeight,r=this.scrollTop<=0;(t<0&&a||0<t&&r)&&e.preventDefault()},t.prototype.registerEventListeners=function(){o(l).each(function(e,t){a.define(o(t),[a.events.activate]),o(t).on(a.events.activate,function(e,t){this.toggleDrawer(t.originalEvent),t.originalEvent.preventDefault()}.bind(this))}.bind(this)),o(n).click(function(){c&&this.closeAll()}.bind(this))},{init:function(){return new t}}});