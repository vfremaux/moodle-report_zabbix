define(["jquery","core/ajax","core/templates"],function(c,t,u){return{processResults:function(e,r){var n=[];return c.each(r,function(e,r){n.push({value:r.id,label:r._label})}),n},transport:function(e,r,a,n){r={query:r},e=c(e).attr("withincourseid");void 0!==e&&""!==c("#id_searchwithin").val()?r.courseid=e:r.courseid=0,t.call([{methodname:"core_search_get_relevant_users",args:r}])[0].then(function(e){var n=[];return c.each(e,function(e,r){n.push(u.render("core_search/form-user-selector-suggestion",r))}),c.when.apply(c.when,n).then(function(){var n=arguments,t=0;c.each(e,function(e,r){r._label=n[t++]}),a(e)})}).fail(n)}}});